<% content_for :head do %>
  <% if @article.draft? %>
    <meta name="robots" content="noindex, nofollow">
  <% end %>
  <% if @article.summary.present? %>
    <meta name="description" content="<%= @article.summary %>">
    <meta property="og:description" content="<%= @article.summary %>">
  <% end %>
  <meta property="og:url" content="<%= request.original_url %>">
  <meta property="og:type" content="article">
  <meta property="og:title" content="<%= @article.title %>">
  <meta property="og:site_name" content="<%= SiteSetting.site_title %>">
  <% og_image_url = @article.og_image_url %>
  <% if og_image_url.present? %>
    <meta property="og:image" content="<%= og_image_url %>">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
  <% end %>
<% end %>

<article class="prose prose-lg max-w-none">
  <header class="l--article-header">
    <h1 class="a--heading is-xxl spec--article-title"><%= @article.title %></h1>
    <div class="flex items-center gap-4 text-sm text-gray-500 mb-4">
      <% if show_author_info? %>
        <span class="spec--article-author">著者: <%= @article.author %></span>
      <% end %>
      <time datetime="<%= @article.created_at.iso8601 %>">
        <%= format_date_with_weekday(@article.created_at) %>
      </time>
    </div>
  </header>

  <% if @article.draft? %>
    <div class="a--card is-warning spec--draft-notice mb-6">
      <h2 class="flex items-center gap-2 text-lg font-semibold mb-2 text-amber-700">
        <span class="material-symbols-outlined text-amber-600" style="font-size: 1.25rem;">warning</span>
        この記事は下書きです
      </h2>
      <p class="text-sm text-amber-700">この記事は現在下書き状態で、一般には公開されていません。</p>
    </div>
  <% end %>

  <div class="a--long-text spec--article-content py-12">
    <%= markdown(@article.body) %>
  </div>
</article>

<div class="mt-8 pt-4 flex gap-2">
  <%= link_to "記事一覧に戻る", root_path, class: "a--button is-md is-border-secondary" %>
  <% if current_user_signed_in? %>
    <%= link_to "編集", edit_admin_article_path(@article), class: "a--button is-md is-border-secondary" %>
    <%= link_to "削除", admin_article_path(@article), method: :delete,
                data: { confirm: "この記事を削除しますか？削除すると元に戻せません。" },
                class: "a--button is-md is-border-danger spec--delete-article-button" %>
  <% end %>
</div>
